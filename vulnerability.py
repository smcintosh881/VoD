#CWE-250
#This vulnerability occurs when a temporary raise in privileges
#is required to perform a specfic action and then the privileges
#are returned to normal.
import os, sys

priv = "normal"

def makeNewUserDir(username):
    try:
        #privileges must be raised to create a directory
        raisePrivileges()
        #create the directory throws an error, therefore the privilege is never lowered
        os.mkdir('/home/' + username)
        #lower privilege back to minimum required
        lowerPrivileges()
    except OSError:
        print('Unable to create new user directory for:' + username)
        return False
    return True

def raisePrivileges():
    global priv
    priv = "admin"

def lowerPrivileges():
    global priv
    priv = "normal"

def main():
    global priv
    makeNewUserDir("Hello_World")
    print("Current privilege is: " + priv)

main()
